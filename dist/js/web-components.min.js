function setTable(element,keyVar,compile,scope){var table=element.find("table"),tr=$("<tr>").attr("ng-repeat",keyVar+" in model track by $index");tr.attr("ng-click","showModal('edit',"+keyVar+",$index)");for(var i=0;i<scope.columns.length;i++){var col=scope.columns[i],td=$("<td>");console.debug("subColumn.createdTd.col.row",col.row),/<[a-z][\s\S]*>/i.test(col.row)?$(col.row).appendTo(td):td.html(col.row),td.appendTo(tr),console.debug("subColumn.createdTd",td)}tr.appendTo(table),compile(table)(scope);var modal=element.find(".modal"),form=modal.find(".modal-content");form.attr("ng-submit","save(action,"+keyVar+")"),modal.on("hidden.bs.modal",function(e){scope.action=void 0});for(var modalBody=modal.find(".modal-body"),i=0;i<scope.columns.length;i++){var col=scope.columns[i];$(col.form).appendTo(modalBody)}compile(modal.contents())(scope)}angular.module("fluid.webComponents.fluidCache",[]).service("fluidCache.service",["$templateCache",function(tc){return this.getCache=function(key){return tc.get(key)},this.putCache=function(key,data){tc.put(key,data),console.debug("fluidCache.service.put.key",key),console.debug("fluidCache.service.put.data",data)},this}]).factory("fluidCache.injector",["fluidCache.service",function(fs){return{response:function(response){return console.debug("fluidCache.injector.response",response),fs.getCache(response.config.url)===!1&&fs.putCache(response.config.url,response.data),response}}}]).directive("fluidCache",["fluidCache.service","$compile",function(fs){return{restrict:"A",link:function(scope,element,attr){element.ready(function(){var obj=scope.$$childHead.$eval(attr.fluidCache);console.debug("fluidCache.cache",obj),obj&&fs.putCache(obj,!1)})}}}]).config(["$httpProvider",function(hp){hp.interceptors.push("fluidCache.injector")}]),angular.module("fluid.webComponents.fluidSelect",[]).directive("fluidSelect",["$templateCache","$http","$compile",function(tc,h,c){return{scope:{model:"=",fieldGroup:"@",fieldValue:"@",fieldLabel:"@",change:"&",name:"@",method:"@"},restrict:"AE",replace:!0,template:tc.get("templates/fluid-select.html"),link:function(scope,element,attr){scope.loaded=!1,attr.label&&(scope.label=attr.label),scope.load=function(){attr.sourceUrl?(scope.isLoading=!0,h({method:scope.method,url:attr.sourceUrl}).success(function(sourceList){scope.sourceList=sourceList,scope.addElements(),c(dropDown.contents())(scope),scope.isLoading=!1,scope.loaded=!0})):attr.values&&(scope.isLoading=!0,scope.sourceList=attr.values.split(","),scope.addElements(),c(dropDown.contents())(scope),scope.isLoading=!1,scope.loaded=!0)},scope.method||(scope.method="GET"),!scope.name&&attr.label&&(scope.name=attr.label.trim().split(" ").join("_")),scope.options="item in sourceList",scope.fieldGroup&&(scope.options+="  | groupBy "+scope.fieldGroup);var itemLabel=scope.fieldLabel?"{{item."+scope.fieldLabel+"}}":"{{item}}",itemValue=scope.fieldValue?"item."+scope.fieldValue:"item",dropDown=element.find("ul.dropdown-menu"),label=element.find("span.label");label.attr("ng-if","model"),scope.fieldValue?label.attr("ng-repeat","item in sourceList | filter : {"+scope.fieldValue+": model}"):label.attr("ng-repeat","item in sourceList | filter : model"),label.html(itemLabel),c(label)(scope),scope.addElements=function(){var listElements=$("<li>").addClass("fluid-select-item").attr("ng-repeat",scope.options).appendTo(dropDown);$("<a>").attr("ng-click","select("+itemValue+",item,$index)").addClass("morris-hover-point").text(itemLabel).appendTo(listElements)},scope.$watch(function(){return attr.sourceUrl},function(){scope.loaded=!1}),scope.$watch(function(){return attr.values},function(value){scope.loaded=!1}),scope.select=function(item,full,$index){scope.model=item,scope.change({item:item,full:full,index:$index})},scope.$watch(function(scope){return scope.model},function(value){value&&(scope.loaded||scope.load())}),scope.look=function(){scope.loaded||scope.load()}}}}]),angular.module("fluid.webComponents.fluidSubTable",[]).directive("fluidSubtable",["$templateCache","$compile",function(tc,c){return{restrict:"AE",template:tc.get("templates/fluid-subtable.html"),transclude:!0,replace:!0,scope:{model:"=",validate:"&"},link:function(scope,element,attr){scope.columns=[],scope.model||(scope.model=[]),attr.sourceUrl&&(scope.sourceUrl=attr.sourceUrl);var modal=element.find(".modal");scope.validate=function(value){return!0},scope.save=function(type,item){"Create"===type?item&&(scope.validate?scope.validate({value:item})&&(scope.model.push(item),scope.hideModal()):(scope.model.push(item),scope.hideModal()),console.debug("create.item",item)):"Edit"===type&&(scope.validate?scope.validate({value:item})&&scope.hideModal():scope.hideModal())},scope.hideModal=function(){modal.modal("hide")},scope.showModal=function(action,item,$index){modal.modal("show"),"create"===action?(scope.action="Create",scope.item=void 0):"edit"===action&&(scope.action="Edit",scope.index=$index,scope.item=scope.model[scope.index])},scope.change=function(item){"Create"===item&&(scope.action=item,scope.selectValue=void 0,modal.modal("show"))},scope.select=function(item){scope.selectedItem=item},scope["delete"]=function(){scope.model.splice(scope.index,1),scope.hideModal()};var transclude=element.find("ng-transclude");if(transclude.find("fluid-subcolumn").each(function(){var column=JSON.parse($(this).attr("column"));scope.columns.push(column)}),attr.label&&(scope.label=attr.label),!attr.keyVar)throw"KeyVar is required.";setTable(element,attr.keyVar,c,scope),transclude.remove()}}}]).directive("fluidSubcolumn",[function(){return{scope:!1,restrict:"AE",template:"<div ng-transclude></div>",link:function(scope,element,attr){var column={};if(!attr.name)throw"Name attribute is required.";column.name=attr.name,attr.header&&(column.header=attr.header),attr.value&&(column.value=attr.value),column.row=element.find("[ng-transclude]").find(".column-row").html(),column.form=element.find("[ng-transclude]").find(".column-form").html(),element.attr("column",JSON.stringify(column))},transclude:!0}}]),angular.module("fluid.webComponents.bootstrap",[]).directive("info",[function(){return{restrict:"A",link:function(scope,element){element.hasClass("fluid-select")?element.find(".dropdown-toggle").addClass("btn-info"):element.hasClass("btn")?element.addClass("btn-info"):element.hasClass("panel")?element.addClass("panel-info"):element.hasClass("fluid-subtable")&&(element.find(".panel").addClass("panel-info"),element.find(".modal").addClass("modal-"))}}}]).directive("warning",[function(){return{restrict:"A",link:function(scope,element){element.hasClass("fluid-select")?element.find(".dropdown-toggle").addClass("btn-warning"):element.hasClass("btn")?element.addClass("btn-warning"):element.hasClass("panel")?element.addClass("panel-warning"):element.hasClass("fluid-subtable")&&element.find(".panel").addClass("panel-warning")}}}]).directive("danger",[function(){return{restrict:"A",link:function(scope,element){element.hasClass("fluid-select")?element.find(".dropdown-toggle").addClass("btn-danger"):element.hasClass("btn")?element.addClass("btn-danger"):element.hasClass("panel")?element.addClass("panel-danger"):element.hasClass("fluid-subtable")&&element.find(".panel").addClass("panel-danger")}}}]).directive("success",[function(){return{restrict:"A",link:function(scope,element){element.hasClass("fluid-select")?element.find(".dropdown-toggle").addClass("btn-success"):element.hasClass("btn")?element.addClass("btn-success"):element.hasClass("panel")?element.addClass("panel-success"):element.hasClass("fluid-subtable")&&element.find(".panel").addClass("panel-success")}}}]).directive("primary",[function(){return{restrict:"A",link:function(scope,element){element.hasClass("fluid-select")?element.find(".dropdown-toggle").addClass("btn-primary"):element.hasClass("btn")?element.addClass("btn-primary"):element.hasClass("panel")?element.addClass("panel-primary"):element.hasClass("fluid-subtable")&&element.find(".panel").addClass("panel-primary")}}}]),angular.module("fluid.webComponents",["angular.filter","fluid.webComponents.bootstrap","fluid.webComponents.fluidCache","fluid.webComponents.fluidSelect","fluid.webComponents.fluidSubTable","wcTemplates"]).directive("fluidDisabled",[function(){return{restrict:"A",link:function(scope,element,attr){scope.$watch(attr.fluidDisabled,function(disabled){disabled?(element.find("input").each(function(){$(this).attr("disabled","")}),element.find("button").each(function(){$(this).attr("disabled","")}),element.find("a").each(function(){$(this).attr("disabled","")})):(element.find("input").each(function(){$(this).removeAttr("disabled")}),element.find("button").each(function(){$(this).removeAttr("disabled")}),element.find("a").each(function(){$(this).removeAttr("disabled")}))})}}}]).controller("sampleCtrl",["$scope",function(scope){scope.labelList=[{label2:"rer",label:"wer"},{label:"3",label2:"w"}]}]),angular.module("wcTemplates",["templates/fluid-select.html","templates/fluid-subtable.html"]),angular.module("templates/fluid-select.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("templates/fluid-select.html",'<label class="control-label fluid-select">{{label}}<div class="btn-group fluid-select-dropdown"><button class="btn btn-lg dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" ng-click="look()" aria-expanded="false"><span class="label"></span> <span ng-if="!model">...</span> <span class="caret"></span></button><ul class="dropdown-menu"><li ng-if="isLoading"><a>Loading {{label ? label : \'selection\'}} <i class="fa fa-spinner fa-spin"></i></a></li></ul></div></label>')}]),angular.module("templates/fluid-subtable.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("templates/fluid-subtable.html",'<div class="fluid-subtable"><ng-transclude></ng-transclude><div class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog"><form class="modal-content" role="form"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">{{label}}</h4></div><div class="modal-body"></div><div class="modal-footer"><div ng-switch="action"><button type="submit" class="btn btn-info btn-lg create">{{action == \'Edit\' ? \'Update\' : action}}</button> <button ng-if="action==\'Edit\'" type="button" class="btn btn-danger btn-lg" ng-click="delete()">Delete</button> <button type="button" class="btn btn-danger btn-lg" ng-click="hideModal()">Cancel</button></div></div></form></div></div><div class="panel"><div class="panel-heading"><span class="panel-title"><b>{{label}}</b></span><div class="panel-title pull-right hidden-xs hidden-sm"><button type="button" class="btn btn-lg btn-info" ng-click="showModal(\'create\')"><i class="fa fa-plus"></i></button> <button ng-if="sourceUrl" type="button" class="btn btn-lg btn-warning"><i class="fa fa-search"></i></button></div><div class="panel-title pull-right hidden-md hidden-lg"><fluid-select change="change(item)" info values="Create,Search" model="selectValue"></fluid-select></div></div><table class="panel-body table table-striped table-condensed table-hover"><thead><th ng-repeat="col in columns">{{col.header}}</th></thead><tbody></tbody></table></div></div>')}]);