"use strict";function getLookupLoader(){return $("<i>").addClass("fa fa-spinner fa-spin")}function getModal(label){var modal=$("<div tabindex='-1' role='dialog'>").addClass("modal fade fluid-lookup"),dialog=$("<div>").addClass("modal-dialog"),content=$("<div>").addClass("modal-content"),modalHeader=$("<div>").addClass("modal-header"),modalBody=$("<div>").addClass("modal-body"),closeButton=$("<button type='button' class='close' data-dismiss='modal' aria-label='Close'>");return closeButton.html("<span aria-hidden='true'>&times;</span>"),dialog.appendTo(modal),content.appendTo(dialog),modalHeader.appendTo(content),modalBody.appendTo(content),closeButton.appendTo(modalHeader),$("<h4>").addClass("modal-title").html("<b>"+label+"</b>").appendTo(modalHeader),modal}function setTable(element,keyVar,compile,scope,modal,value,ngModel,timeout,columns,validate,$filter){var createButton=element.find("button.create"),eraseButton=element.find("button.delete"),toggleColumnsButton=element.find("button.toggle-columns"),toggleColumnsList=element.find("ul.toggle-columns"),sort=void 0,fieldSorted=void 0,modeloc=keyVar+"_oc",keyVarLookup=keyVar+"_lookup",addItem=function(item){var sortedArray=ngModel.$viewValue;sortedArray.push(item),sort&&(sortedArray=$filter("orderBy")(sortedArray,fieldSorted,"desc"===sort)),scope[modeloc]&&scope[modeloc].push(item),ngModel.$setViewValue(sortedArray),timeout(function(){scope.$apply()})},updateItem=function(item,index){var sortedArray=ngModel.$viewValue;sortedArray[index]=item,sort&&(sortedArray=$filter("orderBy")(ngModel.$viewValue,fieldSorted,"desc"===sort)),scope[modeloc]&&(scope[modeloc][index]=item),ngModel.$setViewValue(sortedArray),timeout(function(){scope.$apply()})},removeItem=function(index){ngModel.$viewValue.splice(index,1),scope[modeloc]&&scope[modeloc].splice(index,1),timeout(function(){scope.$apply()})};scope.$watch(function(){return scope[keyVarLookup]},function(lookupModel){lookupModel&&(addItem(lookupModel),scope[keyVarLookup]=void 0,timeout(function(){scope.$apply()}))}),ngModel.$render=function(){ngModel.$viewValue||(ngModel.$setViewValue([]),timeout(function(){scope.$apply()}))};var mode={create:function(){modal.actionButton.addClass("action-create"),modal.actionButton.removeClass("action-edit"),modal.deleteButton.addClass("hidden")},edit:function(){modal.actionButton.removeClass("action-create"),modal.actionButton.addClass("action-edit"),modal.deleteButton.removeClass("hidden")}};createButton.unbind("click"),createButton.click(function(){modal.$modal.modal("show"),modal.actionButton.text("Create"),mode.create(),scope[keyVar]={},timeout(function(){scope.$apply()})}),eraseButton.unbind("click"),eraseButton.click(function(){scope[modeloc]&&(scope[modeloc]=[]),ngModel.$setViewValue([]),timeout(function(){scope.$apply()})}),modal.cancelButton.unbind("click"),modal.cancelButton.click(function(){modal.$modal.modal("hide")}),modal.actionButton.unbind("click"),modal.actionButton.click(function(){if(modal.actionButton.hasClass("action-create"))scope[keyVar]&&(scope.$eval(validate)&&(ngModel.$viewValue||ngModel.$setViewValue([])),addItem(scope[keyVar]),modal.$modal.modal("hide"));else if(modal.actionButton.hasClass("action-edit")&&scope[keyVar]){var $index=modal.actionButton.attr("index");scope.$eval(validate)&&(updateItem(scope[keyVar],$index),modal.$modal.modal("hide"))}}),modal.deleteButton.unbind("click"),modal.deleteButton.click(function(){var $index=modal.deleteButton.attr("index");removeItem($index),modal.$modal.modal("hide")});var table=element.find("table");table.addClass(keyVar);var thead=table.find("thead"),tr=$("<tr>").attr("ng-repeat",keyVar+" in "+value+" track by $index");element.find("table."+keyVar).delegate("tr td","click",function($event){var eventScope=angular.element($event.target).scope();modal.actionButton.text("Update"),modal.actionButton.attr("index",eventScope.$index),modal.deleteButton.attr("index",eventScope.$index),mode.edit();var copy={};angular.copy(ngModel.$viewValue[eventScope.$index],copy),scope[keyVar]=copy,timeout(function(){scope.$apply()}),modal.$modal.modal("show")}),thead.delegate("th.fluid-sort","click",function(){var sorter=$(this).find("a");sort=sorter.attr("sort"),fieldSorted=$(this).attr("field-name");var sorting=thead.attr("sorting");sorting!==fieldSorted&&(thead.find("th[field-name='"+sorting+"']").removeAttr("sort"),thead.find("th[field-name='"+sorting+"'] a").removeClass("fa-sort-desc").removeClass("fa-sort-asc")),void 0===sort?(scope[keyVar+"_oc"]=ngModel.$viewValue,sorter.toggleClass("fa fa-sort-desc"),sorter.attr("sort","asc"),sort="asc"):"asc"===sort?(sorter.toggleClass("fa fa-sort-asc"),sorter.toggleClass("fa fa-sort-desc"),sorter.attr("sort","desc"),sort="desc"):"desc"===sort&&(sorter.removeClass("fa fa-sort-desc"),sorter.removeClass("fa fa-sort-asc"),sorter.removeAttr("sort"),sort=void 0),thead.attr("sorting",fieldSorted);var sorted=void 0;"asc"===sort?sorted=!1:"desc"===sort&&(sorted=!0);var sortedArray=[];void 0!==sorted?(sortedArray=$filter("orderBy")(ngModel.$viewValue,fieldSorted,sorted),sortedArray.sort=sort):angular.copy(scope[modeloc],sortedArray),ngModel.$setViewValue(sortedArray),timeout(function(){scope.$apply()})});for(var columnToggles=0,i=0;i<columns.length;i++){var col=columns[i],td=$("<td>");td.attr("ng-if","!"+keyVar+"_toggled_"+col.name),/<[a-z][\s\S]*>/i.test(col.row)?$(col.row).appendTo(td):td.html(col.row);var th=$("<th>").html(col.header).appendTo(thead);if(th.attr("field-name",col.name),col.sort!==!1&&th.addClass("fluid-sort"),$("<a href='#'>").appendTo(th),td.appendTo(tr),$(col.form).appendTo(modal.body),col.toggle===!0){var tl=$("<li>").appendTo(toggleColumnsList).attr("column-index",i).attr("column-name",col.name),a=$("<a>").attr("href","#").appendTo(tl).html(col.header);$("<input>").attr("type","checkbox").prop("checked",!0).addClass("pull-right").appendTo(a).unbind("click"),columnToggles++}}toggleColumnsList.delegate("li a input","click",function(event){var li=$(this).parent().parent(),checkbox=$(this),columnIndex=li.attr("column-index"),columnName=li.attr("column-name"),toggled=(li.attr("column-toggled"),!checkbox.prop("checked"));li.attr("column-toggled",toggled),thead.find("th:eq("+columnIndex+")").toggleClass("hidden"),scope[keyVar+"_toggled_"+columnName]=toggled,timeout(function(){scope.$apply()})}),0===columnToggles&&toggleColumnsButton.remove(),tr.appendTo(table),compile(table)(scope),timeout(function(){scope.$apply()}),compile(modal.$modal.contents())(scope),element.attr("table-loaded",!0)}function getSubTableModal(label){var $modal=$("<div class='modal fade fluid-subtable fluid-subtable-form' tabindex='-1' role='dialog' data-backdrop='false'>"),$dialog=$("<div class='modal-dialog'>").appendTo($modal),$modalContent=$("<form class='modal-content' role='form'>").css("padding",0).appendTo($dialog),$modalHeader=$("<div class='modal-header'>").appendTo($modalContent);$("<button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>").appendTo($modalHeader),$("<h4 class='modal-title'><b>"+label+"</b></h4>").appendTo($modalHeader);var $modalBody=$("<div class='modal-body container-fluid'>").appendTo($modalContent),$modalFooter=$("<div class='modal-footer'>").appendTo($modalContent),$actionButton=$("<button type='submit' info class='btn btn-lg'>").appendTo($modalFooter),$deleteButton=$("<button type='button' danger class='btn btn-lg'>").html("Delete").appendTo($modalFooter),$cancelButton=$("<button type='button' danger class='btn btn-lg'>").html("Cancel").appendTo($modalFooter);return{$modal:$modal,content:$modalContent,body:$modalBody,actionButton:$actionButton,cancelButton:$cancelButton,deleteButton:$deleteButton}}function getValue(object,field){if(field){for(var item in object)if(item===field){this.value=object[item];break}}else this.value=object;return this}function getBootstrapBrand(attr){var bootstrapBrand="";return void 0!==attr.primary&&(bootstrapBrand="primary"),void 0!==attr.info&&(bootstrapBrand="info"),void 0!==attr.success&&(bootstrapBrand="success"),void 0!==attr.warning&&(bootstrapBrand="warning"),void 0!==attr.danger&&(bootstrapBrand="danger"),bootstrapBrand}angular.module("fluid.webComponents.fluidCache",[]).service("fluidCache.service",["$templateCache",function(tc){return this.getCache=function(key){return tc.get(key)},this.putCache=function(key,data){tc.put(key,data)},this}]).factory("fluidCache.injector",["fluidCache.service",function(fs){return{response:function(response){return fs.getCache(response.config.url)===!1&&fs.putCache(response.config.url,response.data),response}}}]).directive("fluidCache",["fluidCache.service","$compile",function(fs){return{restrict:"A",link:function(scope,element,attr){element.ready(function(){var obj=scope.$$childHead.$eval(attr.fluidCache);obj&&fs.putCache(obj,!1)})}}}]).config(["$httpProvider",function(hp){hp.interceptors.push("fluidCache.injector")}]),angular.module("fluid.webComponents.fluidLookup",[]).directive("fluidLookup",["$http","lookUp",function(h,lookUp){return{restrict:"A",link:function(scope,element,attr,ngModel){var method="get";attr.method&&(method=attr.method),element.unbind("click");var bootstrapBrand=getBootstrapBrand(attr);element.bind("click",function(e){lookUp.open({bootstrapBrand:bootstrapBrand,event:e,ngModel:attr.ngModel,method:method,values:attr.values,sourceUrl:attr.sourceUrl,label:attr.label,factory:attr.factory})})}}}]).directive("fluidLookupGrid",["$templateCache",function(tc){var fluidLookUpGrid={restrict:"AE",terminal:!0,link:function(scope,element,attr){element.addClass("grid");var grid={};if(!attr.keyVar)throw"KeyVar attribute is required.";attr.lookupTemplate?grid.html=tc.get(attr.lookupTemplate):grid.html=element.html(),grid.keyVar=attr.keyVar,element.parent().attr("lookup-type","grid"),element.parent().attr("grid",JSON.stringify(grid)),element.remove()}};return fluidLookUpGrid}]).directive("fluidLookupTable",["$templateCache",function(tc){var fluidLookUpGrid={terminal:!0,restrict:"AE",link:function(scope,element,attr){element.addClass("table");var table={};if(!attr.keyVar)throw"KeyVar attribute is required.";attr.lookupTemplate?table.html=tc.get(attr.lookupTemplate):table.html=element.html(),table.keyVar=attr.keyVar,element.parent().attr("lookup-type","table"),element.parent().attr("table",JSON.stringify(table)),element.remove()}};return fluidLookUpGrid}]).service("lookUp",["$compile","$http","$injector","$timeout",function(c,h,inj,t){this.open=function(options){var event=options.event,method=options.method,sourceUrl=options.sourceUrl,factory=options.factory,scope=angular.element($(event.currentTarget)).scope(),label=options.label,bootstrapBrand=options.bootstrapBrand,source=$(event.currentTarget),modal=getModal(label).attr(bootstrapBrand,""),loader=getLookupLoader(),oldHtml=$(event.currentTarget).html(),keyVar="",modalBody=modal.find(".modal-body"),ngModel=options.ngModel;if("grid"===source.attr("lookup-type")){var grid=JSON.parse(source.attr("grid"));keyVar=grid.keyVar;var tempSearchDiv=$("<div class='form-group'>").appendTo(modalBody);modalBody.attr("ng-init",keyVar+"_search=undefined"),$("<input class='form-control'>").attr("ng-model",keyVar+"_search").attr("placeholder","Search "+label.toLowerCase()).appendTo(tempSearchDiv);var selectorGrid=$("<div>").attr(options.bootstrapBrand,"").addClass("grid").attr("ng-repeat",grid.keyVar+" in "+grid.keyVar+"_data | filter: "+keyVar+"_search").appendTo(modalBody);selectorGrid.html(grid.html),modalBody.delegate("div.grid","click",function($event){if(ngModel){var indexScope=angular.element($event.target).scope(),item=indexScope[grid.keyVar];scope[ngModel]=item,t(function(){scope.$apply()})}modal.modal("hide")}),source.attr("on-lookup")&&(selectorGrid.unbind("click"),selectorGrid.attr("ng-click",source.attr("on-lookup")))}else if("table"===source.attr("lookup-type")){var table=JSON.parse(source.attr("table"));keyVar=table.keyVar;var tableBd=$("<table class='modal-body table lookup-table table-hover table-striped table-condensed'>").attr(options.bootstrapBrand,"").appendTo(modalBody);tableBd.delegate("tr","click",function($event){if(ngModel){var indexScope=angular.element($event.target).scope(),item=indexScope[table.keyVar];scope[ngModel]=item,t(function(){scope.$apply()})}modal.modal("hide")});var thead=$("<thead>").appendTo(tableBd),tr=$("<tr>").attr("ng-repeat",table.keyVar+" in "+table.keyVar+"_data | filter: "+keyVar+"_search").appendTo(tableBd);$(table.html).each(function(){var col=$(this);if(col.hasClass("column-row")){var header=col.attr("header");$("<th>").html(header).appendTo(thead),$("<td>").html(col.html()).appendTo(tr)}});var tempSearchDiv=$("<div class='form-group'>").appendTo(modalBody);modalBody.attr("ng-init",keyVar+"_search=undefined"),$("<input class='form-control'>").attr("ng-model",keyVar+"_search").attr("placeholder","Search "+label.toLowerCase()).appendTo(tempSearchDiv),tableBd.appendTo(modalBody)}c(modal.contents())(scope),sourceUrl?($(event.currentTarget).html(loader),h({method:method,url:sourceUrl}).success(function(data){$(event.currentTarget).html(oldHtml),scope[keyVar+"_data"]=data,t(function(){scope.$apply()}),modal.modal("show")})):factory&&t(function(){scope[keyVar+"_data"]=inj.get(factory),t(function(){scope.$apply()}),modal.modal("show")})}}]),angular.module("fluid.webComponents.fluidPagination",[]).directive("fluidPagination",["$compile","$timeout","Paginate",function(c,t,Paginate){var pagination=function(){var nav=$("<nav>"),ul=$("<ul class='pagination pagination-lg'>").appendTo(nav),previousLi=$("<li>").prependTo(ul),previousLink=$("<a aria-label='Previous'><span aria-hidden='true'>&laquo;</span></a>").appendTo(previousLi),nextLi=$("<li>"),nextLink=$("<a aria-label='Next'><span aria-hidden='true'>&raquo;</span></a>").appendTo(nextLi);return{$pagination:nav,ul:ul,previous:previousLink,next:nextLink}},paginator=function(scope,element,attr){var sourceUrl=attr.sourceUrl,method=attr.method,paginate=new Paginate(sourceUrl,method),pageElement=pagination();pageElement.$pagination.prependTo(element);var createLinks=function(length){pageElement.ul.find("li[page]").remove();var limit=paginate.limit;if(length>limit){var pageCount=Math.ceil(length/limit),total=pageCount*limit,lastIndex=limit;total>length?lastIndex=total-length:length>total&&(lastIndex=length-total),pageElement.ul.attr("max-page",pageCount);for(var start=0,i=0;pageCount>i;i++){var size=limit;i===pageCount-1&&(size=lastIndex);var li=$("<li>").attr("page",i+1).attr("start",start).attr("row-size",size).appendTo(pageElement.ul);0===i&&(li.addClass("active"),pageElement.ul.attr("active-page",1));var a=$("<a>").html(i+1).appendTo(li);a.unbind("click"),start+=limit}pageElement.next.parent().appendTo(pageElement.ul),pageElement.next.unbind("click"),pageElement.next.click(function(){var maxPage=pageElement.ul.attr("max-page"),currentPage=pageElement.ul.attr("active-page");if(currentPage||(currentPage=1),maxPage>currentPage){currentPage++;var li=pageElement.ul.find("li[page="+currentPage+"]");li.trigger("click")}})}else{var li=$("<li class='active'>").appendTo(pageElement.ul),a=$("<a>").html("1").appendTo(li);a.attr("page",1).attr("start",0).attr("row-size",length),a.unbind("click")}};pageElement.previous.unbind("click"),pageElement.previous.click(function(){var currentPage=pageElement.ul.attr("active-page");if(currentPage>1){currentPage--;var li=pageElement.ul.find("li[page="+currentPage+"]");li.trigger("click")}});var query=function(start){start&&(paginate.start=start),paginate.getResultList().success(function(result){paginate.length=result.length,paginate.resultSize=result.data.length,scope[attr.ngModel]=result.data,t(function(){scope.$apply()})})},refresh=function(){paginate.limit||(paginate.limit=scope.$eval(attr.limit)),paginate.start=0,paginate.getResultList().success(function(result){paginate.length=result.length,paginate.resultSize=result.data.length,scope[attr.ngModel]=result.data,createLinks(paginate.length)})},refreshPage=function(){var currentPage=pageElement.ul.attr("active-page"),li=pageElement.ul.find("li[page="+currentPage+"]");li.trigger("click")};if(pageElement.ul.delegate("li[page]","click",function(event){var page=$(this),start=page.attr("start"),currentPage=page.attr("page"),activePage=pageElement.ul.attr("active-page");activePage&&currentPage!==activePage&&pageElement.ul.find("li[page="+activePage+"]").removeClass("active"),page.addClass("active"),pageElement.ul.attr("active-page",currentPage),query(start)}),scope.$watch(attr.limit,function(limit){limit&&(paginate.setLimit(scope.$eval(limit)),refresh())}),refresh(),attr.bottom){var bottom=scope.$eval(attr.bottom);bottom&&pageElement.$pagination.appendTo(element)}element.find("th.fluid-sort").each(function(){var thead=$(this).parent();thead.off();var sorter=$(this).find("a");sorter||(sorter=$("<a href='#'>").appendTo($(this))),$(this).click(function(){var sort=sorter.attr("sort"),fieldSorted=$(this).attr("field-name"),sorting=thead.attr("sorting");sorting!==fieldSorted&&(thead.find("th[field-name='"+sorting+"']").removeAttr("sort"),thead.find("th[field-name='"+sorting+"'] a").removeClass("fa-sort-desc").removeClass("fa-sort-asc")),void 0===sort?(sorter.toggleClass("fa fa-sort-desc"),sorter.attr("sort","asc"),sort="asc"):"asc"===sort?(sorter.toggleClass("fa fa-sort-asc"),sorter.toggleClass("fa fa-sort-desc"),sorter.attr("sort","desc"),sort="desc"):"desc"===sort&&(sorter.removeClass("fa fa-sort-desc"),sorter.removeClass("fa fa-sort-asc"),sorter.removeAttr("sort"),sort=void 0);var sorted=void 0;"asc"===sort?sorted=!1:"desc"===sort?sorted=!0:fieldSorted=void 0,thead.attr("sorting",fieldSorted),paginate.setSort(fieldSorted,sort),refreshPage()})})},preFluidPaginationLink=function(scope,element,attr,ngModel){if(!attr.sourceUrl)throw"attribute source-url is required.";element.addClass("fluid-pagination"),c(element.contents())(scope)},postFluidPaginationLink=function(scope,element,attr,ngModel){paginator(scope,element,attr)},fluidPagination={restrict:"AE",terminal:!0,require:"ngModel",link:{pre:preFluidPaginationLink,post:postFluidPaginationLink}};return fluidPagination}]).factory("Paginate",["$http",function(h){var paginate=function(url,method){this.start=0,this.url=url,this.method=method,this.setSort=function(field,sort){this.sort={field:field,sort:sort}},this.setLimit=function(limit){this.limit=limit},this.getResultList=function(){if("get"===this.method.toLowerCase()){var params={};return params.start=this.start,this.sort&&(params.field=this.sort.field,params.sort=this.sort.sort),this.limit&&(params.limit=this.limit),h({params:params,url:this.url,method:this.method})}return"post"===this.method.toLowerCase?h({data:this,url:this.url,method:this.method}):void 0}};return paginate}]),angular.module("fluid.webComponents.fluidSelect",[]).directive("fluidSelect",["$templateCache","$http","$compile","$injector","$timeout","$filter","$q",function(tc,h,c,inj,t,f,q){return{require:"ngModel",restrict:"AE",template:tc.get("templates/fluid-select.html"),link:function(scope,element,attr,ngModel){var method="GET",sourceList=void 0,fwcLabel=element.find(".fwc-label"),fieldValue=void 0,fieldLabel=void 0,loaded=!1;attr.label&&fwcLabel.html(attr.label),attr.method||(method="GET"),!attr.name&&attr.label&&(attr.name=attr.label.trim().split(" ").join("_")),attr.fieldLabel&&(fieldLabel=attr.fieldLabel),attr.fieldValue&&(fieldValue=attr.fieldValue);var dropDown=element.find("ul.dropdown-menu"),loader=$("<li><a>Loading "+(attr.label?attr.label:"selection")+" <i class='fa fa-spinner fa-spin'></i></a> </li>"),label=element.find("span.label"),lookupButton=element.find("button.look");lookupButton.click(function($event){look()});var look=function(){loaded||load()},createList=function(items){loader.remove(),angular.forEach(items,function(item){var li=$("<li>").addClass("fluid-select-item"),a=$("<a>").attr("href","#").addClass("morris-hover-point").text(new getValue(item,fieldLabel).value).appendTo(li);a.click(function($event){var value=new getValue(item,fieldValue).value;t(function(){ngModel.$setViewValue(value,$event),t(function(){scope.$apply()})})}),li.appendTo(dropDown)})},load=function(){var deferred=q.defer();return dropDown.html(loader[0]),attr.sourceUrl?h({method:method,url:attr.sourceUrl}).success(function(data){sourceList=data,createList(data),loaded=!0,deferred.resolve(sourceList)}):attr.values?(sourceList=attr.values.split(","),createList(sourceList),loaded=!0,deferred.resolve(sourceList)):attr.factory&&(sourceList=inj.get(attr.factory),createList(sourceList),loaded=!0,deferred.resolve(sourceList)),deferred.promise},setValue=function(dataValue){if(dataValue)if(loaded){var itemLabel=f("filter")(sourceList,dataValue),value=new getValue(itemLabel[0],fieldValue).value;label.text(value)}else load().then(function(data){var itemLabel=f("filter")(data,dataValue),value=new getValue(itemLabel[0],fieldValue).value;label.text(value)});else label.text("")};ngModel.$render=function(){setValue(ngModel.$viewValue)},ngModel.$viewChangeListeners.push(function(){ngModel.$render()})}}}]),angular.module("fluid.webComponents.fluidSubcomponent",[]).directive("fluidSubcomponent",["fluidSubcomponent",function(fc){var fluidSubcomponent={restrict:"AE",terminal:!0,compile:function(elem,attrs){var link=function(scope,element,attr){if(!attr.tag)throw"Please define fluid web component tag [tag='']";var subComponent=$(fc.getSubcomponent(attr.tag).htmlTag);$.each(attr.$attr,function(k,v){"tag"===k||"fluidSubcomponent"===k||subComponent.attr(v,attr[k])}),subComponent.html(element.html()),element.replaceWith(subComponent)};return link}};return fluidSubcomponent}]).provider("fluidSubcomponent",function fluidSubcomponentProvider(){this.subcomponents=[],this.subcomponents["fluid-select"]={htmlTag:"<fluid-select>"},this.subcomponents["fluid-subtable"]={htmlTag:"<fluid-subtable>"},this.subcomponents["fluid-subcolumn"]={htmlTag:"<fluid-subcolumn>"},this.subcomponents.li={htmlTag:"<li>"},this.subcomponents.div={htmlTag:"<div>"},this.subcomponents.tr={htmlTag:"<tr>"},this.subcomponents.th={htmlTag:"<th>"},this.subcomponents.td={htmlTag:"<td>"},this.subcomponents.ul={htmlTag:"<ul>"},this.setSubcomponent=function(name,options){return this.subcomponents[name]=options,this},this.$get=[function(){var subcom=new fluidSubcomponentProvider;return subcom.getSubcomponent=function(name){return subcom.subcomponents[name]},subcom}]}),angular.module("fluid.webComponents.fluidSubTable",[]).directive("fluidSubtable",["$templateCache","$compile","$timeout","$filter","fluidClient",function(tc,c,t,f,fc){var keyVar=void 0;return{restrict:"AE",require:"ngModel",template:tc.get("templates/fluid-subtable.html"),transclude:!0,link:{pre:function(scope,element,attr){var loaded=attr.tableLoaded;if(!loaded){var fluidLookupButton=element.find("button[fluid-lookup]");if(attr.sourceUrl&&fluidLookupButton.attr("source-url",attr.sourceUrl),attr.factory&&fluidLookupButton.attr("factory",attr.factory),attr.label&&(element.find(".fst-label").html(attr.label),fluidLookupButton.attr("label",attr.label)),attr.method&&fluidLookupButton.attr("method",method),!attr.keyVar)throw"key-var attribute is required.";keyVar=fc.getKeyVar(attr.keyVar);var bootstrapBrand=getBootstrapBrand(attr);bootstrapBrand&&fluidLookupButton.attr("ng-model",keyVar+"_lookup").attr(bootstrapBrand,""),fluidLookupButton.attr("title","Look "+(attr.label?"for "+attr.label:"up")),scope[keyVar+"_lookup"]=void 0,t(function(){scope.$apply()}),c(fluidLookupButton)(scope)}},post:function(scope,element,attr,ngModel){var loaded=attr.tableLoaded,columns=[],fluidLookupButton=element.find("button[fluid-lookup]"),transclude=element.find("ng-transclude"),validate="true",grid=$("<fluid-lookup-grid>").attr("key-var","gridItem"),gridContainer=$("<div>").addClass("fluid-grid").appendTo(grid),bootstrapBrand=getBootstrapBrand(attr);if(!loaded){if(scope[attr.ngModel]||(scope[attr.ngModel]=[],t(function(){scope.$apply()})),attr.lookupTemplate&&grid.attr("lookup-template",attr.lookupTemplate),attr.validate&&(validate=attr.validate),attr.showClear){var showClear=scope.$eval(attr.showClear);if(void 0!==showClear&&showClear===!1){var eraseButton=element.find("button.delete");eraseButton.remove()}}else{var eraseButton=element.find("button.delete");eraseButton.attr("title","Clear "+(attr.label?attr.label:""))}if(attr.showAdd){var showAdd=scope.$eval(attr.showAdd);if(void 0!==showAdd&&showAdd===!1){var createButton=element.find("button.create");createButton.remove()}}else{var createButton=element.find("button.create");createButton.attr("title","add "+(attr.label?attr.label:""))}for(var index=0;index<transclude.children().length;index++){var subColumn=$(transclude.children()[index]);if(subColumn.is("fluid-subcolumn")){var column=JSON.parse(subColumn.attr("column"));$("<div>").html("{{gridItem."+column.name+"}}").appendTo(gridContainer),columns.push(column)}}attr.sourceUrl||attr.factory?(grid.appendTo(fluidLookupButton),c(fluidLookupButton)(scope)):fluidLookupButton.addClass("hidden");var modal=getSubTableModal(attr.label);bootstrapBrand&&(modal.$modal.attr(bootstrapBrand,""),element.find("button.toggle-columns").attr(bootstrapBrand,""),c(element.find("button.toggle-columns"))(scope)),setTable(element,keyVar,c,scope,modal,attr.ngModel,ngModel,t,columns,validate,f),transclude.remove()}}}}}]).directive("fluidSubcolumn",["$compile",function(c){return{restrict:"AE",terminal:!0,link:{pre:function(scope,element,attr,controller,transcludeFn){},post:function(scope,element,attr){var column={filter:!0};if(!attr.name)throw"Name attribute is required.";column.name=attr.name,attr.header&&(column.header=attr.header),attr.filter&&(column.filter=scope.$eval(attr.filter)),attr.toggleColumns&&(column.toggleColumns=scope.$eval(attr.toggleColumns)),attr.value&&(column.value=attr.value),attr.sort&&(column.sort=scope.$eval(attr.sort)),attr.toggle?column.toggle="true"===attr.toggle:column.toggle=!0,column.row=element.find(".column-row").html();var form=element.find(".column-form").html();column.form=form,element.attr("column",JSON.stringify(column)),element.html("")}}}}]),angular.module("fluid.utils",[]).factory("FluidIterator",["$timeout","$q",function(t,$q){var fluidIterator=function(values){function hasNext(){return length>index}function traverse(nextCallback){var value=void 0;index<array.length?value=array[index]:index--,nextCallback(value,index,function(timeout){index++,hasNext()?t(function(){traverse(nextCallback)},timeout):endOnly?t(function(){traverse(nextCallback)},timeout):(index--,q.resolve({index:index,data:array[index]}))},function(data){q.resolve({index:index,data:data?data:array[index]})})}function next(nextCallback){try{traverse(nextCallback)}catch(err){q.reject(err)}return q.promise}function setEndCallbackOnly(end){endOnly=end}var endOnly=!1,q=$q.defer(),array=values,length=array.length,index=0;return{next:next,length:length,setEndCallbackOnly:setEndCallbackOnly}};return fluidIterator}]).factory("FluidAsyncIterator",["$http","$q","$timeout",function($h,$q,$t){var fluidAsyncIterator=function(url,method){function hasNext(){return length>index}function query(){return $h({url:url,method:method,params:{index:index}})}function traverse(nextCallback){var value=void 0;query().success(function(data){length=data.length,length>index?value=data.value:index--,nextCallback(value,index,function(timeout){index++,hasNext()?$t(function(){traverse(nextCallback)},timeout):endOnly?$t(function(){traverse(nextCallback)},timeout):(index--,q.resolve({index:index,data:value}))},function(data){q.resolve({index:index,data:data?data:value})})}).error(function(err){q.reject(err)})}function next(nextCallback){try{traverse(nextCallback)}catch(err){q.reject(err)}return q.promise}function setEndCallbackOnly(end){endOnly=end}var endOnly=!1,q=$q.defer(),length=0,index=0,method=method?method:"GET";return{next:next,length:length,setEndCallbackOnly:setEndCallbackOnly}};return fluidAsyncIterator}]).service("fluidClient",[function(){return this.getKeyVar=function(keyVar){if(this.keyVars||(this.keyVars=[]),null!=this.keyVars[keyVar]){var keys=this.keyVars[keyVar];return keys++,this.keyVars[keyVar]=keys,keyVar+"_"+keys}return this.keyVars[keyVar]=0,keyVar},this}]),angular.module("fluid.webComponents.bootstrap",[]).directive("info",[function(){return{restrict:"A",link:function(scope,element){element.is("fluid-select")?element.find(".dropdown-toggle").addClass("btn-info"):element.hasClass("btn")?element.addClass("btn-info"):element.hasClass("panel")?element.addClass("panel-info"):element.is("fluid-subtable")?(element.find(".panel").addClass("panel-info"),element.find(".modal.fluid-subtable-form").find(".modal-header").addClass("bg-info")):element.hasClass("modal")?element.find("modal-header").addClass("bg-info"):element.is("table")}}}]).directive("warning",[function(){return{restrict:"A",link:function(scope,element){element.is("fluid-select")?element.find(".dropdown-toggle").addClass("btn-warning"):element.hasClass("btn")?element.addClass("btn-warning"):element.hasClass("panel")?element.addClass("panel-warning"):element.is("fluid-subtable")?(element.find(".panel").addClass("panel-warning"),element.find(".modal.fluid-subtable-form").find(".modal-header").addClass("bg-warning")):element.hasClass("modal")&&element.find("modal-header").addClass("bg-warning")}}}]).directive("danger",[function(){return{restrict:"A",link:function(scope,element){element.is("fluid-select")?element.find(".dropdown-toggle").addClass("btn-danger"):element.hasClass("btn")?element.addClass("btn-danger"):element.hasClass("panel")?element.addClass("panel-danger"):element.is("fluid-subtable")?(element.find(".panel").addClass("panel-danger"),element.find(".modal.fluid-subtable-form").find(".modal-header").addClass("bg-danger")):element.hasClass("fluid-lookup")?element.find(".modal").find(".modal-header").addClass("bg-danger"):element.hasClass("modal")&&element.find("modal-header").addClass("bg-danger")}}}]).directive("success",[function(){return{restrict:"A",link:function(scope,element){element.is("fluid-select")?element.find(".dropdown-toggle").addClass("btn-success"):element.hasClass("btn")?element.addClass("btn-success"):element.hasClass("panel")?element.addClass("panel-success"):element.is("fluid-subtable")?element.find(".panel").addClass("panel-success"):element.hasClass("modal")&&element.find("modal-header").addClass("bg-success")}}}]).directive("primary",[function(){return{restrict:"A",link:function(scope,element){element.is("fluid-select")?element.find(".dropdown-toggle").addClass("btn-primary"):element.hasClass("btn")?element.addClass("btn-primary"):element.hasClass("panel")?element.addClass("panel-primary"):element.is("fluid-subtable")?(element.find(".panel").addClass("panel-primary"),element.find(".modal.fluid-subtable-form").find(".modal-header").addClass("bg-primary")):element.hasClass("fluid-lookup")?element.find(".modal").find(".modal-header").addClass("bg-primary"):element.hasClass("modal")&&element.find("modal-header").addClass("bg-primary")}}}]),angular.module("fluid.webComponents",["angular.filter","fluid.utils","fluid.webComponents.fluidSubcomponent","fluid.webComponents.bootstrap","fluid.webComponents.fluidCache","fluid.webComponents.fluidSelect","fluid.webComponents.fluidSubTable","fluid.webComponents.fluidLookup","fluid.webComponents.fluidPagination","wcTemplates"]).directive("fluidDisabled",[function(){return{restrict:"A",link:function(scope,element,attr){scope.$watch(attr.fluidDisabled,function(disabled){disabled?(element.find("input").each(function(){$(this).attr("disabled","")}),element.find("button").each(function(){$(this).attr("disabled","")}),element.find("a").each(function(){$(this).attr("disabled","")})):(element.find("input").each(function(){$(this).removeAttr("disabled")}),element.find("button").each(function(){$(this).removeAttr("disabled")}),element.find("a").each(function(){$(this).removeAttr("disabled")}))})}}}]).controller("sampleCtrl",["$scope","FluidAsyncIterator",function(scope,FluidAsyncIterator){
scope.taskSize=5,scope.year=1957,scope.sample="rer",scope.change=function(item){},scope.onLookUp=function(item,$event){scope.selectedSample=item};var iterator=new FluidAsyncIterator("http://localhost:9080/rex-services/services/flow_task_query/sample_tasks");iterator.setEndCallbackOnly(!0),iterator.next(function(value,index,proceed){proceed()})}]).factory("samples",function(){return[{name:"Jerico",year:1991,list:[{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"}]},{name:"Pogi",year:1991,list:[{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"}]},{name:"John Doe",year:1978,list:[{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"}]},{name:"James Hitler",year:1998,list:[{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"}]},{name:"Anita",year:1998,list:[{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"}]},{name:"Calcium Kid",year:1998,list:[{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"},{name:"Someone Else",year:"1976"}]}]}),angular.module("wcTemplates",["templates/fluid-select.html","templates/fluid-subtable.html"]),angular.module("templates/fluid-select.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("templates/fluid-select.html",'<label class="control-label fluid-select"><span class="fwc-label"></span><div class="btn-group fluid-select-dropdown"><button class="btn btn-lg dropdown-toggle look" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="label"></span> <span class="caret"></span></button><ul class="dropdown-menu"></ul></div></label>')}]),angular.module("templates/fluid-subtable.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("templates/fluid-subtable.html",'<div class="fluid-subtable"><ng-transclude></ng-transclude><div class="panel"><div class="panel-heading"><div class="panel-title fluid-table-panel-title center-block"><span class="hidden-xs hidden-sm"><b class="fst-label"></b></span> <span class="pull-right btn-group btn-group-lg" role="group"><button type="button" class="btn btn-lg btn-info create"><i class="fa fa-plus"></i></button> <button type="button" class="btn btn-lg btn-danger delete"><i class="fa fa-eraser"></i></button> <button fluid-lookup type="button" class="btn btn-lg btn-warning"><i class="fa fa-search"></i></button><div class="btn-group btn-group-lg" role="group"><button class="btn toggle-columns" title="Toggle columns" data-toggle="dropdown"><i class="fa fa-th-list"></i> <span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-right toggle-columns"></ul></div></span></div></div><table class="panel-body table table-striped table-condensed table-hover"><thead></thead><tbody></tbody></table></div></div>')}]);